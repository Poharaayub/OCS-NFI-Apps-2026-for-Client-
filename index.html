<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#F2F2F7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>OCS NFI Apps 26</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
    
    <style>
        :root {
            --ios-bg: #F2F2F7;
            --ios-surface: #FFFFFF; 
            --ios-primary: #007AFF;
            --ios-text: #000000;
            --ios-secondary-text: #8E8E93;
            --ios-separator: rgba(60, 60, 67, 0.12);
            --nav-height: 68px;
        }

        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            margin: 0; padding: 0; 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            letter-spacing: -0.015em;
        }

        body { 
            background-color: var(--ios-bg); 
            height: 100dvh; width: 100vw; overflow: hidden;
            color: var(--ios-text);
            -webkit-font-smoothing: antialiased;
        }

        header {
            padding: calc(env(safe-area-inset-top) + 24px) 20px 14px;
            background: rgba(242, 242, 247, 0.85);
            backdrop-filter: saturate(180%) blur(25px);
            -webkit-backdrop-filter: saturate(180%) blur(25px);
            position: fixed; top: 0; left: 0; right: 0; z-index: 40;
            border-bottom: 0.5px solid var(--ios-separator);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .large-title {
            font-size: 34px;
            font-weight: 800;
            margin-top: 8px;
            color: #000;
            transition: transform 0.2s ease, font-size 0.2s ease;
        }

        header.scrolled {
            padding-top: calc(env(safe-area-inset-top) + 12px);
            padding-bottom: 12px;
        }
        header.scrolled .large-title {
            font-size: 17px;
            text-align: center;
            margin-top: 0;
            transform: translateY(-4px);
        }
        header.scrolled .app-badge { opacity: 0; transform: translateY(-10px); }

        .app-badge {
            font-size: 12px;
            font-weight: 700;
            color: var(--ios-primary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: 0.3s ease;
        }

        .page-container { height: 100dvh; width: 100%; position: relative; }

        .page { 
            display: none; height: 100%; width: 100%; 
            overflow-y: auto; -webkit-overflow-scrolling: touch;
            padding: calc(135px + env(safe-area-inset-top)) 16px calc(var(--nav-height) + env(safe-area-inset-bottom) + 40px);
        }
        .page.full-page { padding: 0 !important; height: 100dvh; z-index: 10; }
        .page.active { display: block; animation: ios-slide-up 0.4s cubic-bezier(0.16, 1, 0.3, 1); }

        @keyframes ios-slide-up { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        nav {
            position: fixed; 
            bottom: calc(20px + env(safe-area-inset-bottom)); 
            left: 20px; 
            right: 20px;
            height: var(--nav-height);
            background: rgba(255, 255, 255, 0.88); 
            backdrop-filter: saturate(200%) blur(35px);
            -webkit-backdrop-filter: saturate(200%) blur(35px);
            display: flex; 
            z-index: 50; 
            border-radius: 35px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.12), 0 0 0 0.5px rgba(0,0,0,0.04);
            padding: 0 10px;
            max-width: 550px;
            margin: 0 auto;
        }
        
        .n-btn { 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; flex: 1; 
            color: var(--ios-secondary-text); 
            transition: all 0.2s ease;
        }
        .n-btn.active { color: var(--ios-primary); }
        
        .n-btn .material-symbols-rounded { 
            font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 20; 
            font-size: 26px; 
            margin-bottom: 3px;
        }
        .n-btn.active .material-symbols-rounded { 
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 20; 
        }
        
        .n-txt { 
            font-size: 10px; 
            font-weight: 600; 
            letter-spacing: 0.01em;
        }

        .card-list {
            background: var(--ios-surface);
            border-radius: 14px;
            overflow: hidden;
            margin-bottom: 28px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.02);
        }

        .card { 
            background: var(--ios-surface); padding: 12px 16px; 
            display: flex; align-items: center; width: 100%;
            transition: background 0.1s;
            position: relative;
        }
        .card:not(:last-child)::after {
            content: "";
            position: absolute; bottom: 0; left: 62px; right: 0;
            height: 0.5px; background: var(--ios-separator);
        }
        .card:active { background: #E5E5EA; }
        
        .c-icon { 
            width: 34px; height: 34px; border-radius: 9px; 
            color: white; display: flex; align-items: center; 
            justify-content: center; margin-right: 14px; flex-shrink: 0; 
        }
        .c-icon .material-symbols-rounded { font-size: 20px; }

        .fab { 
            width: 60px; height: 60px; border-radius: 30px; 
            display: flex; align-items: center; justify-content: center; 
            position: fixed; bottom: calc(var(--nav-height) + env(safe-area-inset-bottom) + 38px); 
            right: 24px; z-index: 60; background: var(--ios-primary); color: white;
            box-shadow: 0 10px 30px rgba(0,122,255,0.3);
            transform: scale(0) rotate(-45deg); opacity: 0; 
            transition: 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .fab.visible { transform: scale(1) rotate(0); opacity: 1; }

        #scrim { 
            position: fixed; inset: 0; 
            background: rgba(0,0,0,0.4); 
            z-index: 1000; 
            display: none; 
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        
        /* BOTTOM SHEET */
        #sheet { 
            position: fixed; 
            bottom: 0; left: 0; right: 0; 
            background: var(--ios-surface); 
            z-index: 1001; 
            border-radius: 24px 24px 0 0; 
            transform: translateY(100%);
            transition: transform 0.5s cubic-bezier(0.32, 0.72, 0, 1);
            height: calc(96dvh - env(safe-area-inset-top)); 
            max-width: 800px; 
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.15);
        }

        .sheet-visible #sheet { transform: translateY(0); }
        .sheet-visible #scrim { display: block; opacity: 1; }
        
        .sheet-handle { 
            width: 36px; height: 5px; 
            background: rgba(60, 60, 67, 0.15); 
            border-radius: 100px; 
            margin: 10px auto;
            flex-shrink: 0;
        }

        .sheet-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: 8px 20px 16px;
            border-bottom: 0.5px solid var(--ios-separator);
        }

        .sheet-content-scroll {
            flex: 1; overflow-y: auto; background: var(--ios-bg);
            -webkit-overflow-scrolling: touch;
        }

        .ios-field { 
            background: #FFFFFF; 
            padding: 14px 16px; 
            display: flex; 
            align-items: center; 
            position: relative;
        }
        .ios-field:not(:last-child)::after {
            content: ""; position: absolute; bottom: 0; left: 16px; right: 0;
            height: 0.5px; background: var(--ios-separator);
        }
        .ios-input { flex: 1; border: none; outline: none; font-size: 17px; background: transparent; width: 100%; color: #000; }
        
        .section-header {
            font-size: 13px; text-transform: uppercase; color: var(--ios-secondary-text);
            margin: 24px 0 10px 18px; font-weight: 600; letter-spacing: 0.04em;
        }

        .spinner {
            width: 24px; height: 24px;
            border: 3px solid rgba(0, 122, 255, 0.1);
            border-top: 3px solid var(--ios-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body id="app-body">

    <header id="main-header">
        <div class="flex justify-between items-center w-full">
            <span class="app-badge">OCS NFI Apps 26</span>
        </div>
        <div id="h-title" class="large-title">Request</div>
    </header>

    <div id="fab-daily" class="fab" onclick="handleExternalClick('https://drive.google.com/drive/folders/18_DNs4WHDtNw0QvqfZ0Uvx9sAgVVZlz9')">
        <span class="material-symbols-rounded !text-[28px]">folder_zip</span>
    </div>

    <div id="fab-periodik" class="fab" onclick="handleExternalClick('https://drive.google.com/drive/folders/1Y-sgaereUh9w-HSFwXsGm4GYHN9dLn9Y')">
        <span class="material-symbols-rounded !text-[28px]">cloud_sync</span>
    </div>

    <div id="scrim" onclick="closeSheet()"></div>
    <div id="sheet">
        <div class="sheet-handle"></div>
        <div class="sheet-header">
            <button onclick="closeSheet()" class="text-blue-500 font-medium text-[17px] active:opacity-40 transition-opacity">Batal</button>
            <h2 id="s-title" class="text-[17px] font-bold text-center truncate flex-1 px-4">Detail</h2>
            <div class="min-w-[65px] flex justify-end">
                 <button id="btn-external" class="text-blue-500 hidden active:opacity-40 transition-opacity"><span class="material-symbols-rounded">ios_share</span></button>
                 <button id="btn-done" onclick="closeSheet()" class="text-blue-500 font-bold hidden active:opacity-40 transition-opacity">Selesai</button>
            </div>
        </div>
        
        <div id="sheet-content-area" class="flex-1 relative overflow-hidden flex flex-col">
            <div id="loading-ui" class="absolute inset-0 flex items-center justify-center bg-white/90 z-20 hidden">
                <div class="spinner"></div>
            </div>
            <div id="sheet-content" class="sheet-content-scroll"></div>
        </div>
    </div>

    <div class="page-container">
        <div id="p1" class="page full-page">
            <iframe id="iframe-daily" class="w-full h-full border-none" src="https://poharaayub.github.io/Daily-activity-for-client/" loading="lazy"></iframe>
        </div>
        
        <div id="p2" class="page full-page">
            <iframe id="iframe-periodik" class="w-full h-full border-none" src="about:blank" loading="lazy"></iframe>
        </div>
        
        <div id="p3" class="page active"></div>
        <div id="p4" class="page"></div>
        <div id="p5" class="page"></div>
    </div>

    <nav>
        <div class="n-btn" onclick="go('p1', 'Daily', this)">
            <span class="material-symbols-rounded">task_alt</span>
            <span class="n-txt">Daily</span>
        </div>
        <div class="n-btn" onclick="go('p2', 'Periodik', this)">
            <span class="material-symbols-rounded">history_edu</span>
            <span class="n-txt">Periodik</span>
        </div>
        <div id="default-nav-btn" class="n-btn active" onclick="go('p3', 'Request', this)">
            <span class="material-symbols-rounded">add_circle</span>
            <span class="n-txt">Request</span>
        </div>
        <div class="n-btn" onclick="go('p4', 'Laporan', this)">
            <span class="material-symbols-rounded">analytics</span>
            <span class="n-txt">Laporan</span>
        </div>
        <div class="n-btn" onclick="go('p5', 'Member', this)">
            <span class="material-symbols-rounded">contacts</span>
            <span class="n-txt">Member</span>
        </div>
    </nav>

    <script>
        const members = [
            { n: "Junaidi", d: "OCS Area Manager", p: "6285886607991" },
            { n: "Pohara Ayub", d: "Team Leader", p: "6289637126728" },
            { n: "Sadulloh", d: "Team Leader", p: "6285281587927" },
            { n: "Sulaiman", d: "CSO Head Office Jakarta", p: "6285716230391" },
            { n: "Saiful Bahri", d: "CSO Office Lantai 1", p: "6281389327308" },
            { n: "Siti Maemunah", d: "CSO Office Lantai 2", p: "6285771090915" },
            { n: "Wahidin", d: "Gardener", p: "6283819602330" },
            { n: "Edi Ahmad Jubaedi", d: "CSO Produksi", p: "6285883524329" },
            { n: "Ade Surahman", d: "CSO Produksi", p: "6281947172711" },
            { n: "Muhammad Toni", d: "CSO Produksi", p: "6281286448626" },
            { n: "M. Rifai", d: "CSO Produksi", p: "6285810611074" },
            { n: "Amrullah", d: "CSO Warehouse 2 & 1", p: "6283879624040" },
            { n: "Nabrih", d: "WH Tepung Specialist", p: "6281295412005" }
        ];

        const menuData = {
            p3: [
                {l:"Request ke Team Leader", i:"chat_bubble", s:"req_tl", c:"bg-[#5856D6]"}, 
                {l:"Request ke Cleaner", i:"mop", s:"req_cso", c:"bg-[#34C759]"},
                {l:"Feedback & Komplain", i:"priority_high", s:"feedback_form", c:"bg-[#FF3B30]"}
            ],
            p4: [
                {l:"Daily Activity", i:"description", url:"https://drive.google.com/drive/folders/1s5BLnmuqGbP3XHq0d30Y1xCUk-tiTejy", ext:true, c:"bg-[#8E8E93]"},
                {l:"Periodik Cleaning", i:"cleaning_services", url:"https://drive.google.com/drive/folders/1Q7djVthlF5452-4H1NZJVw6Cm3fn7zS8", ext:true, c:"bg-[#8E8E93]"},
                {l:"Cleaning Filter Air Shower", i:"water_lux", url:"https://docs.google.com/spreadsheets/d/1qLT8OZwqT_LqWT7u5XLUJT2wVpOWFh7i3S56aAB-dNk/edit?usp=drivesdk", ext:false, c:"bg-[#007AFF]"},
                {l:"Jadwal Shift Member", i:"event_note", url:"https://poharaayub.github.io/Shift-schedule-OCS-NFI-Apps-26/", ext:false, c:"bg-[#007AFF]"},
                {l:"Arsip Big Cleaning", i:"star", url:"https://drive.google.com/drive/folders/1c1mQZI8IuOqy1HnGMozhmQqVbvW--vpz", ext:true, c:"bg-[#FFCC00]"},
                {l:"Laporan Cuci Box", i:"inventory", url:"https://docs.google.com/spreadsheets/d/1vf2pzwlvdsm17cyo1Zrc6DBUL4EeQOng5uJjU12aYvg/edit", c:"bg-[#34C759]"},
                {l:"Laporan Cuci Pallet", i:"grid_view", url:"https://docs.google.com/spreadsheets/d/13dPCq4lEhV4PRA4z2RLQEmPbOIBK9emuclkxk-Dh7iU/edit", c:"bg-[#34C759]"},
                {l:"Pallet Warehouse Tepung", i:"warehouse", url:"https://docs.google.com/spreadsheets/d/1C9Zrywvi_ggnHnKHB9fxUU9f-DCWaGNFJflKqbHVEnI/edit", ext:false, c:"bg-[#5856D6]"},
                {l:"Tentang aplikasi", i:"info", s:"about_apps", c:"bg-[#1C1C1E]"}
            ]
        };

        let sheetIsOpen = false;

        function go(id, title, el) {
            document.querySelectorAll('.n-btn').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            const current = document.getElementById(id);
            current.classList.add('active');
            
            const header = document.getElementById('main-header');
            const fabDaily = document.getElementById('fab-daily');
            const fabPeriodik = document.getElementById('fab-periodik');
            
            header.style.display = (id === 'p1' || id === 'p2') ? 'none' : 'block';
            fabDaily.classList.toggle('visible', id === 'p1');
            fabPeriodik.classList.toggle('visible', id === 'p2');
            
            if(id === 'p2' && document.getElementById('iframe-periodik').src === "about:blank") {
                document.getElementById('iframe-periodik').src = "https://poharaayub.github.io/OCS-NFI-Job-Desk-Apps-Client-/";
            }

            renderPage(id);
            document.getElementById('h-title').innerText = title;
            current.scrollTop = 0;
            header.classList.remove('scrolled');
        }

        document.querySelectorAll('.page').forEach(page => {
            page.addEventListener('scroll', (e) => {
                const header = document.getElementById('main-header');
                if (e.target.scrollTop > 20) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
        });

        function renderPage(id) {
            const container = document.getElementById(id);
            if(!container || id === 'p2' || id === 'p1') return;
            container.innerHTML = '';
            
            if(id === 'p5') {
                const wrap = document.createElement('div');
                wrap.innerHTML = `<div class="card-list">` + 
                    members.map(m => createCard(m.n, "person", `chat('${m.p}', 'Halo ${m.n}, mohon bantuan di area...')`, m.d, "bg-[#8E8E93]")).join('') + `</div>`;
                container.appendChild(wrap);
            } else if(menuData[id]) {
                const listWrap = document.createElement('div');
                listWrap.innerHTML = `<div class="card-list">` + 
                    menuData[id].map(item => {
                        let act = item.s ? `openMenuSheet('${item.s}')` : (item.ext ? `handleExternalClick('${item.url}')` : `openInSheet('${item.l}','${item.url}')`);
                        return createCard(item.l, item.i, act, "", item.c);
                    }).join('') + `</div>`;
                container.appendChild(listWrap);
            }
        }

        function createCard(t, i, a, d="", color="bg-blue-500") {
            return `
            <button class="card" onclick="${a}">
                <div class="c-icon ${color}">
                    <span class="material-symbols-rounded !text-[20px]">${i}</span>
                </div>
                <div class="flex-1 text-left overflow-hidden">
                    <div class="font-normal text-[17px] text-slate-900 truncate">${t}</div>
                    ${d ? `<div class="text-[13px] text-slate-400 mt-0.5 truncate">${d}</div>` : ''}
                </div>
                <span class="material-symbols-rounded text-slate-300 !text-[20px] ml-2">chevron_right</span>
            </button>`;
        }

        function openSheet(title) {
            document.getElementById('s-title').innerText = title;
            document.getElementById('app-body').classList.add('sheet-visible');
            sheetIsOpen = true;
            history.pushState({s:1}, "");
        }

        function openInSheet(title, url) {
            const container = document.getElementById('sheet-content');
            const loader = document.getElementById('loading-ui');
            const btnExt = document.getElementById('btn-external');
            const btnDone = document.getElementById('btn-done');
            
            btnExt.onclick = () => window.open(url, '_blank');
            btnExt.classList.remove('hidden');
            btnDone.classList.add('hidden');
            
            container.innerHTML = ''; 
            loader.classList.remove('hidden');

            const pUrl = url.includes('spreadsheets') ? url.replace(/\/edit.*$/, '/preview') : url;
            const f = document.createElement('iframe');
            f.className = "w-full h-full border-none opacity-0 transition-opacity duration-300";
            f.src = pUrl;
            f.onload = () => { 
                loader.classList.add('hidden'); 
                f.classList.remove('opacity-0'); 
            };
            container.appendChild(f);
            openSheet(title);
        }

        function openMenuSheet(type) {
            const content = document.getElementById('sheet-content');
            const btnExt = document.getElementById('btn-external');
            const btnDone = document.getElementById('btn-done');
            
            btnExt.classList.add('hidden');
            btnDone.classList.add('hidden');
            
            let html = '<div class="pb-24">';
            let title = "";

            if (type === 'about_apps') {
                title = "Tentang aplikasi";
                html += `
                <div class="flex flex-col items-center py-12 px-6">
                    <div class="w-24 h-24 bg-gradient-to-br from-blue-500 to-blue-600 rounded-[24%] flex items-center justify-center mb-6 shadow-lg">
                         <span class="material-symbols-rounded text-white !text-5xl">verified</span>
                    </div>
                    <h3 class="text-2xl font-bold tracking-tight">OCS NFI Apps 26</h3>
                    <p class="text-slate-500 text-sm mb-8">Version 1.3.0 â€¢ Portal Client</p>
                    
                    <div class="card-list w-full">
                        <div class="card flex justify-between">
                            <span class="text-slate-500">Pengembang</span>
                            <span class="font-semibold">Pohara Ayub</span>
                        </div>
                        <div class="card flex justify-between">
                            <span class="text-slate-500">Layanan</span>
                            <span class="font-semibold">Proyek NFI</span>
                        </div>
                    </div>
                </div>`;
            } else if (type === 'feedback_form') {
                title = "Feedback Client";
                btnDone.classList.remove('hidden');
                btnDone.onclick = submitFeedback;

                html += `
                <div class="px-4">
                    <div class="section-header">LOKASI & AREA</div>
                    <div class="card-list">
                        <div class="ios-field"><input type="text" id="f-name" class="ios-input" placeholder="Nama Area Kerja"></div>
                        <div class="ios-field">
                            <select id="f-category" class="ios-input appearance-none">
                                <option>Kebersihan Area</option>
                                <option>Kinerja Cleaner</option>
                                <option>Ketersediaan Barang</option>
                                <option>Saran / Masukan</option>
                            </select>
                        </div>
                    </div>
                    <div class="section-header">PESAN DETAIL</div>
                    <div class="card-list">
                        <div class="ios-field" style="padding:0">
                            <textarea id="f-message" class="ios-input p-4 min-h-[200px]" placeholder="Apa yang ingin Anda sampaikan?"></textarea>
                        </div>
                    </div>
                </div>`;
            } else {
                title = type==='req_tl'?"Team Leader":"Pilih Cleaner";
                const list = type==='req_tl' ? members.filter(m=>m.d.includes("Leader")||m.d.includes("Manager")) : members.filter(m=>!m.d.includes("Leader")&&!m.d.includes("Manager"));
                html += `<div class="px-4 mt-6"><div class="card-list">` + 
                    list.map(m => createCard(m.n, "chat_bubble", `chat('${m.p}','Halo ${m.n}, mohon bantuan di area...')`, m.d, "bg-blue-500")).join('') + `</div></div>`;
            }
            html += '</div>';
            content.innerHTML = html;
            openSheet(title);
        }

        function submitFeedback() {
            const name = document.getElementById('f-name').value;
            const category = document.getElementById('f-category').value;
            const message = document.getElementById('f-message').value;
            if(!name || !message) return;
            const waText = `*OCS CLIENT FEEDBACK*%0A%0AðŸ“ *Lokasi:* ${name}%0AðŸŽ« *Kategori:* ${category}%0A%0AðŸ“ *Pesan:*%0A${message}`;
            window.open(`https://wa.me/6289637126728?text=${waText}`, '_blank');
            closeSheet();
        }

        function closeSheet() { 
            document.getElementById('app-body').classList.remove('sheet-visible'); 
            if(sheetIsOpen) history.back(); 
            sheetIsOpen = false; 
        }

        function handleExternalClick(url) { window.open(url, '_blank'); }
        window.onpopstate = () => { if(sheetIsOpen) { document.getElementById('app-body').classList.remove('sheet-visible'); sheetIsOpen=false; } };
        function chat(p, m) { window.open(`https://wa.me/${p}?text=${encodeURIComponent(m)}`, '_blank'); }

        window.onload = () => { 
            const defaultBtn = document.getElementById('default-nav-btn');
            go('p3', 'Request', defaultBtn);
        };
    </script>
</body>
</html>

